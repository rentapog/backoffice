<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>User Control Panel</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            background: #f4f6fa;
            font-family: 'Montserrat', Arial, sans-serif;
        }

        .container {
            max-width: 700px;
            margin: 40px auto;
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 4px 32px rgba(0, 31, 91, 0.10);
            padding: 40px 32px;
        }

        h1 {
            color: #0033a0;
            text-align: center;
            margin-bottom: 32px;
        }

        .msg {
            color: #e60000;
            text-align: center;
            margin-bottom: 16px;
        }

        .file-manager {
            margin: 32px 0;
        }

        .file-list {
            list-style: none;
            padding: 0;
        }

        .file-list li {
            background: #f4f8fb;
            border-radius: 8px;
            margin-bottom: 10px;
            padding: 10px 18px;
            color: #0033a0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .file-list li span {
            flex: 1;
        }

        .file-list li a {
            color: #e60000;
            text-decoration: none;
            font-weight: bold;
            margin-left: 16px;
        }

        .upload-form {
            margin-bottom: 24px;
            text-align: center;
        }

        .btn-primary {
            background: #0033a0;
            color: #fff;
            border: none;
            border-radius: 6px;
            padding: 10px 24px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
        }

        .btn-primary:hover {
            background: #e60000;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>Welcome, {{ username }}!</h1>
        {% if msg %}<div class="msg">{{ msg }}</div>{% endif %}
        <div class="file-manager">
            <form class="upload-form" method="POST" enctype="multipart/form-data">
                <label for="site">Select Site/Domain:</label>
                <input type="text" name="site" value="{{ username }}" placeholder="Site/Domain"
                    style="margin-bottom:10px;">
                <input type="file" name="file" multiple required>
                <button type="submit" class="btn-primary">Upload Files</button>
            </form>
            <h2>Your Files</h2>
            <ul class="file-list">
                {% for file in files %}
                <li>
                    <span>{{ file }}</span>
                    <a href="/user/control/download?site={{ username }}&file={{ file }}" target="_blank">Download</a>
                    <form method="POST" action="/user/control/delete" style="display:inline; margin-left:10px;">
                        <input type="hidden" name="site" value="{{ username }}">
                        <input type="hidden" name="file" value="{{ file }}">
                        <button type="submit" class="btn-primary" style="background:#e60000;">Delete</button>
                    </form>
                </li>
                {% else %}
                <li>No files uploaded yet.</li>
                {% endfor %}
            </ul>
        </div>

        <!-- Coey AI Assistant Chat Box -->
        <div style="margin-top:40px; background:#f4f8fb; border-radius:8px; padding:24px;">
            <h2 style="color:#0033a0;">Need Help?</h2>
            <form id="coey-form" method="POST" action="/backoffice/coey">
                <input type="text" name="coey-task" placeholder="Ask Coey how to use the control panel..."
                    style="width:70%;padding:10px;">
                <button type="submit" class="btn-primary">Ask Coey</button>
            </form>
            {% if coey_response %}
            <div style="margin-top:16px; color:#0033a0; background:#fff; border-radius:6px; padding:16px;">{{
                coey_response }}</div>
            {% endif %}
        </div>

        <!-- Claude AI Chat Box -->
        <div style="margin-top:40px; background:#f4f8fb; border-radius:8px; padding:24px;">
            <h2 style="color:#0033a0;">Claude AI Chat</h2>
            <form id="claude-form" method="POST" action="/claude">
                <input type="text" name="prompt" placeholder="Ask Claude anything..." style="width:70%;padding:10px;">
                <button type="submit" class="btn-primary">Ask Claude</button>
            </form>
            {% if response %}
            <div style="margin-top:16px; color:#0033a0; background:#fff; border-radius:6px; padding:16px;">{{ response }}</div>
            {% endif %}
        </div>
    </div>
</body>

</html>